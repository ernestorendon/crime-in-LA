<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crime Trends</title>
    <script src="https://cdn.zingchart.com/zingchart.min.js"></script>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        /* Page Layout */
        .container {
            display: grid;
            grid-template-columns: 0.5fr 3fr; /* Left: 1 part, Right: 3 parts */
            height: 100vh;
        }
        
        /* Right Column - Chart */
        .chart-container {
            padding: 20px;
            background-color: #0D0D49;
            color: white;
        }

        #crime-trend-chart {
            width: 100%;
            height: 500px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Left Column: Collapsible Buttons -->
        <div class="button-column">
            <h2>Filter by...</h2>
            <h3 onclick="toggleCrimeButtons()">Crimes</h3>
            <div id="crime-buttons" class="collapsible">
                <button onclick="loadChart('Central')">Central</button>
                <button onclick="loadChart('Devonshire')">Devonshire</button>
                <button onclick="loadChart('Foothill')">Foothill</button>
                <button onclick="loadChart('Harbor')">Harbor</button>
                <button onclick="loadChart('Hollenbeck')">Hollenbeck</button>
                <button onclick="loadChart('Hollywood')">Hollywood</button>
                <button onclick="loadChart('Mission')">Mission</button>
                <button onclick="loadChart('Newton')">Newton</button>
                <button onclick="loadChart('N Hollywood')">N Hollywood</button>
                <button onclick="loadChart('Northeast')">Northeast</button>
                <button onclick="loadChart('Olympic')">Olympic</button>
                <button onclick="loadChart('Pacific')">Pacific</button>
                <button onclick="loadChart('Rampart')">Rampart</button>
                <button onclick="loadChart('Southeast')">Southeast</button>
                <button onclick="loadChart('Southwest')">Southwest</button>
                <button onclick="loadChart('Topanga')">Topanga</button>
                <button onclick="loadChart('Van Nuys')">Van Nuys</button>
                <button onclick="loadChart('West LA')">West LA</button>
                <button onclick="loadChart('West Valley')">West Valley</button>
                <button onclick="loadChart('Wilshire')">Wilshire</button>
                <button onclick="loadChart('77th Street')">77th Street</button>
            </div>
            <h3 onclick="toggleAreaButtons()">Areas</h3>
            <div id="area-buttons" class="collapsible">
                <button onclick="loadChart('Central')">Central</button>
                <button onclick="loadChart('Devonshire')">Devonshire</button>
                <button onclick="loadChart('Foothill')">Foothill</button>
                <button onclick="loadChart('Harbor')">Harbor</button>
                <button onclick="loadChart('Hollenbeck')">Hollenbeck</button>
                <button onclick="loadChart('Hollywood')">Hollywood</button>
                <button onclick="loadChart('Mission')">Mission</button>
                <button onclick="loadChart('Newton')">Newton</button>
                <button onclick="loadChart('N Hollywood')">N Hollywood</button>
                <button onclick="loadChart('Northeast')">Northeast</button>
                <button onclick="loadChart('Olympic')">Olympic</button>
                <button onclick="loadChart('Pacific')">Pacific</button>
                <button onclick="loadChart('Rampart')">Rampart</button>
                <button onclick="loadChart('Southeast')">Southeast</button>
                <button onclick="loadChart('Southwest')">Southwest</button>
                <button onclick="loadChart('Topanga')">Topanga</button>
                <button onclick="loadChart('Van Nuys')">Van Nuys</button>
                <button onclick="loadChart('West LA')">West LA</button>
                <button onclick="loadChart('West Valley')">West Valley</button>
                <button onclick="loadChart('Wilshire')">Wilshire</button>
                <button onclick="loadChart('77th Street')">77th Street</button>
            </div>
        </div> 
    
        <!-- Right Column: Chart -->
        <div class="chart-container">
            <h1>Data Visualizer</h1>
            <div id="crime-trend-chart"></div>
        </div>
        
        <!-- Footer placeholder -->
        <div id="footer-placeholder"></div>
    </div>

    <script>
        // Function to Load Chart Data for Selected Area
        function loadChart(area) {
            fetch(`../fetch_data.php?area=${encodeURIComponent(area)}`)
                .then(response => response.json())
                .then(data => {
                    // Extract months and counts from the data
                    const months = data.map(item => item.month);
                    const counts = data.map(item => item.count);
                    // ZingChart configuration
                    const chartConfig = {
                        type: 'line',
                        backgroundColor: 'transparent',
                        title: {
                            text: `Crime Trends in ${area}`,
                            fontColor: '#FFFFFF', // White font for the title
                            fontSize: 18,
                            adjustLayout: true,
                            y: 20
                        },
                        scaleX: {
                            label: {
                                text: 'Month',
                                fontColor: '#FFFFFF' // White font for the X-axis label
                            },
                            item: {
                                fontColor: '#FFFFFF', // White font for X-axis tick labels
                                fontSize: 9
                            },
                            labels: months
                        },
                        scaleY: {
                            label: {
                                text: 'Number of Crimes',
                                fontColor: '#FFFFFF' // White font for the Y-axis label
                            },
                            item: {
                                fontColor: '#FFFFFF' // White font for Y-axis tick labels
                            }
                        },
                        tooltip: {
                            text: '%t: %v', // Tooltip content
                            fontColor: '#FFFFFF', // White font for tooltips
                            backgroundColor: '#333333', // Optional: Darker background for contrast
                            borderRadius: 5
                        },
                        series: [
                            {
                                values: counts,
                                text: 'Crimes',
                                backgroundColor: '#FFFFFF', // Optional: Make series labels white
                            }
                        ],
                        plot: {
                            marker: {
                                backgroundColor: '#FFFFFF', // Optional: White marker points
                                borderWidth: 1,
                                borderColor: '#FFFFFF'
                            },
                            tooltip: {
                                fontColor: '#FFFFFF' // White text in tooltips
                            }
                        },
                        plotarea: {
                            marginTop: 50,
                            margin: 'dynamic'
                        }
                    };
                    console.log("Chart data to render:", chartConfig);
                    // Render the chart
                    zingchart.render({
                        id: 'crime-trend-chart',
                        data: chartConfig,
                        height: '100%',
                        width: '100%'
                    });
                    console.log("Chart rendered successfully.");
                })
                .catch(error => console.error('Error loading chart data:', error));
        }
        // Load default area (Central) on page load
        window.onload = () => loadChart('Central');
    </script>
    
    <script>
        function toggleAreaButtons() {  
        const areaButtons = document.getElementById('area-buttons');
        areaButtons.classList.toggle('expanded');
    }
    </script>

    <script>
        function toggleCrimeButtons() {
        const areaButtons = document.getElementById('crime-buttons');
        areaButtons.classList.toggle('expanded');
    }
    </script>

    <script>
        // JavaScript to load footer content
        fetch('../footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer-placeholder').innerHTML = data;
            })
            .catch(error => console.error('Error loading footer:', error));
    </script>

</body>
</html>
